{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/src/connect-four.coffee","index.min.js","app/src/index.coffee","app/src/spinner.coffee","node_modules/aye-aye/lib/game.js","node_modules/aye-aye/lib/minimax.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","ConnectFour","MAX","MIN","O","X","_","copy","empty","evaluate","freePositions","isFull","isTerminal","isWin","openColumns","openPosition","play","ref","ref1","repr","scores","winOn","winnableIndices","winner","wonIndices","j","k","l","m","q","res","push","sort","x","y","Math","min","apply","i1","i2","i3","i4","len","ref2","ref3","ref4","W","arg","indices","results","columnIndex","index","rowIndex","b","Array","len1","score","boardStr","col","piece","row","a1","nextPlayer","depth","this","prototype","nextAgent","utility","possibleActions","constructor","opponent","toString","aye-aye","2","$","hideSpinner","showSpinner","jQuery","checkGameOver","computerPlayer","createPlayerO","createPlayerX","game","humanPlayer","lastAction","markWin","newGame","next","playAction","playable","playerO","playerX","players","setup","swapPlayers","teardown","unplayable","className","addClass","removeClass","off","wonClass","endText","text","modal","action","playerText","player","human","starter AI","smart AI","playerName","$o","$x","tmp","on","$btn","$player","currentPlayerName","playerFor","data","int","s","parseInt","done","playableClassName","$tile","get","id","worker","Worker","onmessage","postMessage","command","args","terminate","lastPlayedPosition","./connect-four","./spinner","3","spinner","spinnerThresholdMs","spinnerTimeout","Spinner","lines","radius","target","setTimeout","spin","clearTimeout","stop","4","P1","P2","5","Limit","MinimaxAgent","Number","MAX_SAFE_INTEGER","rootAgent","nextAction","state","bestAction","minimax","α","β","ply","maxi","mini","nextValue","ref5","successor","v","max","./game"],"mappings":"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","file":"index.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","# coffeelint: disable=max_line_length\n{MAX, MIN} = require 'aye-aye'\n\n[_, X, O] = [0, 1, 2]\n\n# empty board\nempty = [\n  _, _, _, _, _, _, _\n  _, _, _, _, _, _, _\n  _, _, _, _, _, _, _\n  _, _, _, _, _, _, _\n  _, _, _, _, _, _, _\n  _, _, _, _, _, _, _\n]\n\n# array with all 4-tuple indices of board positions\n# where a player can win the game\nwinnableIndices = do ->\n  res = []\n  for i in [0...4]\n    # rows\n    for j in [0...6]\n      k=i+j*7\n      res.push [k,k+1,k+2,k+3]\n    # left diagonals\n    for j in [0...3]\n      k=i+j*7\n      res.push [k,k+7+1,k+7*2+2,k+7*3+3]\n  for j in [0...3]\n    # columns\n    for i in [0...7]\n      k=i+j*7\n      res.push [k,k+7,k+7*2,k+7*3]\n    # right diagonals\n    for i in [3...7]\n      k=i+j*7\n      res.push [k,k+7-1,k+7*2-2,k+7*3-3]\n  # sort based on bottom-up board position\n  res.sort (x, y) -> (Math.min y...) - (Math.min x...)\n\nwinner = (a) ->\n  for [i1,i2,i3,i4] in winnableIndices\n    return a[i1] if a[i1] isnt _ and a[i1] is a[i2] is a[i3] is a[i4]\n  null\n\nisWin = (a, W) -> (winner a) is W\n\nwonIndices = (a, [i1,i2,i3,i4]) ->\n  a[i1] isnt _ and a[i1] is a[i2] is a[i3] is a[i4]\n\nwinOn = (a) ->\n  for indices in winnableIndices\n    return indices if wonIndices a, indices\n  []\n\nisFull = (a) ->\n  for i in [0...7]\n    return no if a[i] is _\n  yes\n\nisTerminal = (a) ->\n  (isFull a) or !!(winner a)\n\nopenColumns = (a) ->\n  i for i in [0...7] when a[i] is _\n\nfreePositions = (a) ->\n  i for i in [0...42] when a[i] is _\n\nopenPosition = (a, columnIndex) ->\n  for rowIndex in [5..0]\n    index = rowIndex*7+columnIndex\n    return index if a[index] is _\n\n# this is a bit faster than using Array::slice\ncopy = (a) ->\n  i = 42\n  b = new Array i\n  b[i] = a[i] while i--\n  b\n\nplay = (a, columnIndex, W) ->\n  index = openPosition a, columnIndex\n  b = copy a\n  b[index] = W\n  b\n\nscores = [1,10,100,1000,10000]\nevaluate = (a) ->\n  score = 0\n  for indices in winnableIndices\n    [x, o] = [0, 0]\n    for i in indices\n      ++x if a[i] is X\n      ++o if a[i] is O\n    score += scores[x] - scores[o] if x is 0 or o is 0\n  score\n\nrepr = (a) ->\n  boardStr = \"\"\n  for row in [0...6]\n    for col in [0...7]\n      piece = a[row * 7 + col]\n      if piece is X\n        boardStr += \"X \"\n      else if piece is O\n        boardStr += \"O \"\n      else\n        boardStr += \"_ \"\n    boardStr += \"\\n\"\n  boardStr\n\nclass ConnectFour\n  constructor: (@a = empty, @nextPlayer = X, @depth = 0) ->\n  isWin: (W) -> isWin @a, W\n  winOn: -> winOn @a\n  winner: -> winner @a\n  isTerminal: -> @depth >= 7 and isTerminal @a\n  nextAgent: -> if @nextPlayer is X then MAX else MIN\n  utility: -> evaluate @a\n  freePositions: -> freePositions @a\n  openPosition: (columnIndex) -> openPosition @a, columnIndex\n  possibleActions: -> openColumns @a\n  play: (columnIndex) ->\n    new @constructor (play @a, columnIndex, @nextPlayer), @opponent(), @depth + 1\n  opponent: -> if @nextPlayer is X then O else X\n  toString: -> repr @a\n\nmodule.exports = {\n  _, X, O\n  empty\n  winner, isWin, winOn, isFull, isTerminal\n  freePositions, openColumns, openPosition, play, evaluate\n  ConnectFour\n}\n","(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\nvar ConnectFour, MAX, MIN, O, X, _, copy, empty, evaluate, freePositions, isFull, isTerminal, isWin, openColumns, openPosition, play, ref, ref1, repr, scores, winOn, winnableIndices, winner, wonIndices;\n\nref = require('aye-aye'), MAX = ref.MAX, MIN = ref.MIN;\n\nref1 = [0, 1, 2], _ = ref1[0], X = ref1[1], O = ref1[2];\n\nempty = [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _];\n\nwinnableIndices = (function() {\n  var i, j, k, l, m, n, p, q, r, res;\n  res = [];\n  for (i = l = 0; l < 4; i = ++l) {\n    for (j = m = 0; m < 6; j = ++m) {\n      k = i + j * 7;\n      res.push([k, k + 1, k + 2, k + 3]);\n    }\n    for (j = n = 0; n < 3; j = ++n) {\n      k = i + j * 7;\n      res.push([k, k + 7 + 1, k + 7 * 2 + 2, k + 7 * 3 + 3]);\n    }\n  }\n  for (j = p = 0; p < 3; j = ++p) {\n    for (i = q = 0; q < 7; i = ++q) {\n      k = i + j * 7;\n      res.push([k, k + 7, k + 7 * 2, k + 7 * 3]);\n    }\n    for (i = r = 3; r < 7; i = ++r) {\n      k = i + j * 7;\n      res.push([k, k + 7 - 1, k + 7 * 2 - 2, k + 7 * 3 - 3]);\n    }\n  }\n  return res.sort(function(x, y) {\n    return (Math.min.apply(Math, y)) - (Math.min.apply(Math, x));\n  });\n})();\n\nwinner = function(a) {\n  var i1, i2, i3, i4, l, len, ref2, ref3, ref4;\n  for (l = 0, len = winnableIndices.length; l < len; l++) {\n    ref2 = winnableIndices[l], i1 = ref2[0], i2 = ref2[1], i3 = ref2[2], i4 = ref2[3];\n    if (a[i1] !== _ && ((a[i1] === (ref4 = a[i2]) && ref4 === (ref3 = a[i3])) && ref3 === a[i4])) {\n      return a[i1];\n    }\n  }\n  return null;\n};\n\nisWin = function(a, W) {\n  return (winner(a)) === W;\n};\n\nwonIndices = function(a, arg) {\n  var i1, i2, i3, i4, ref2, ref3;\n  i1 = arg[0], i2 = arg[1], i3 = arg[2], i4 = arg[3];\n  return a[i1] !== _ && ((a[i1] === (ref3 = a[i2]) && ref3 === (ref2 = a[i3])) && ref2 === a[i4]);\n};\n\nwinOn = function(a) {\n  var indices, l, len;\n  for (l = 0, len = winnableIndices.length; l < len; l++) {\n    indices = winnableIndices[l];\n    if (wonIndices(a, indices)) {\n      return indices;\n    }\n  }\n  return [];\n};\n\nisFull = function(a) {\n  var i, l;\n  for (i = l = 0; l < 7; i = ++l) {\n    if (a[i] === _) {\n      return false;\n    }\n  }\n  return true;\n};\n\nisTerminal = function(a) {\n  return (isFull(a)) || !!(winner(a));\n};\n\nopenColumns = function(a) {\n  var i, l, results;\n  results = [];\n  for (i = l = 0; l < 7; i = ++l) {\n    if (a[i] === _) {\n      results.push(i);\n    }\n  }\n  return results;\n};\n\nfreePositions = function(a) {\n  var i, l, results;\n  results = [];\n  for (i = l = 0; l < 42; i = ++l) {\n    if (a[i] === _) {\n      results.push(i);\n    }\n  }\n  return results;\n};\n\nopenPosition = function(a, columnIndex) {\n  var index, l, rowIndex;\n  for (rowIndex = l = 5; l >= 0; rowIndex = --l) {\n    index = rowIndex * 7 + columnIndex;\n    if (a[index] === _) {\n      return index;\n    }\n  }\n};\n\ncopy = function(a) {\n  var b, i;\n  i = 42;\n  b = new Array(i);\n  while (i--) {\n    b[i] = a[i];\n  }\n  return b;\n};\n\nplay = function(a, columnIndex, W) {\n  var b, index;\n  index = openPosition(a, columnIndex);\n  b = copy(a);\n  b[index] = W;\n  return b;\n};\n\nscores = [1, 10, 100, 1000, 10000];\n\nevaluate = function(a) {\n  var i, indices, l, len, len1, m, o, ref2, score, x;\n  score = 0;\n  for (l = 0, len = winnableIndices.length; l < len; l++) {\n    indices = winnableIndices[l];\n    ref2 = [0, 0], x = ref2[0], o = ref2[1];\n    for (m = 0, len1 = indices.length; m < len1; m++) {\n      i = indices[m];\n      if (a[i] === X) {\n        ++x;\n      }\n      if (a[i] === O) {\n        ++o;\n      }\n    }\n    if (x === 0 || o === 0) {\n      score += scores[x] - scores[o];\n    }\n  }\n  return score;\n};\n\nrepr = function(a) {\n  var boardStr, col, l, m, piece, row;\n  boardStr = \"\";\n  for (row = l = 0; l < 6; row = ++l) {\n    for (col = m = 0; m < 7; col = ++m) {\n      piece = a[row * 7 + col];\n      if (piece === X) {\n        boardStr += \"X \";\n      } else if (piece === O) {\n        boardStr += \"O \";\n      } else {\n        boardStr += \"_ \";\n      }\n    }\n    boardStr += \"\\n\";\n  }\n  return boardStr;\n};\n\nConnectFour = (function() {\n  function ConnectFour(a1, nextPlayer, depth) {\n    this.a = a1 != null ? a1 : empty;\n    this.nextPlayer = nextPlayer != null ? nextPlayer : X;\n    this.depth = depth != null ? depth : 0;\n  }\n\n  ConnectFour.prototype.isWin = function(W) {\n    return isWin(this.a, W);\n  };\n\n  ConnectFour.prototype.winOn = function() {\n    return winOn(this.a);\n  };\n\n  ConnectFour.prototype.winner = function() {\n    return winner(this.a);\n  };\n\n  ConnectFour.prototype.isTerminal = function() {\n    return this.depth >= 7 && isTerminal(this.a);\n  };\n\n  ConnectFour.prototype.nextAgent = function() {\n    if (this.nextPlayer === X) {\n      return MAX;\n    } else {\n      return MIN;\n    }\n  };\n\n  ConnectFour.prototype.utility = function() {\n    return evaluate(this.a);\n  };\n\n  ConnectFour.prototype.freePositions = function() {\n    return freePositions(this.a);\n  };\n\n  ConnectFour.prototype.openPosition = function(columnIndex) {\n    return openPosition(this.a, columnIndex);\n  };\n\n  ConnectFour.prototype.possibleActions = function() {\n    return openColumns(this.a);\n  };\n\n  ConnectFour.prototype.play = function(columnIndex) {\n    return new this.constructor(play(this.a, columnIndex, this.nextPlayer), this.opponent(), this.depth + 1);\n  };\n\n  ConnectFour.prototype.opponent = function() {\n    if (this.nextPlayer === X) {\n      return O;\n    } else {\n      return X;\n    }\n  };\n\n  ConnectFour.prototype.toString = function() {\n    return repr(this.a);\n  };\n\n  return ConnectFour;\n\n})();\n\nmodule.exports = {\n  _: _,\n  X: X,\n  O: O,\n  empty: empty,\n  winner: winner,\n  isWin: isWin,\n  winOn: winOn,\n  isFull: isFull,\n  isTerminal: isTerminal,\n  freePositions: freePositions,\n  openColumns: openColumns,\n  openPosition: openPosition,\n  play: play,\n  evaluate: evaluate,\n  ConnectFour: ConnectFour\n};\n\n\n},{\"aye-aye\":5}],2:[function(require,module,exports){\nvar $, ConnectFour, O, X, hideSpinner, ref, ref1, showSpinner;\n\n$ = jQuery;\n\nref = require('./connect-four'), X = ref.X, O = ref.O, ConnectFour = ref.ConnectFour;\n\nref1 = require('./spinner'), showSpinner = ref1.showSpinner, hideSpinner = ref1.hideSpinner;\n\n$(function() {\n  var checkGameOver, computerPlayer, createPlayerO, createPlayerX, game, humanPlayer, lastAction, markWin, newGame, next, playAction, playable, playerO, playerX, players, setup, swapPlayers, teardown, unplayable;\n  game = null;\n  lastAction = null;\n  playable = function() {\n    var className, i, j, len, ref2;\n    className = game.nextPlayer === X ? 'x-playable-tile' : 'o-playable-tile';\n    ref2 = game.freePositions();\n    for (j = 0, len = ref2.length; j < len; j++) {\n      i = ref2[j];\n      $(\"#\" + i).addClass(className);\n    }\n    return className;\n  };\n  unplayable = function() {\n    return $('.tile').removeClass('x-playable-tile').removeClass('o-playable-tile').removeClass('human-playable-tile').off('click');\n  };\n  markWin = function() {\n    var i, j, len, ref2, results, wonClass;\n    ref2 = game.winOn();\n    results = [];\n    for (j = 0, len = ref2.length; j < len; j++) {\n      i = ref2[j];\n      wonClass = game.isWin(X) ? 'x-won-tile' : 'o-won-tile';\n      results.push(($(\"#\" + i)).addClass(wonClass));\n    }\n    return results;\n  };\n  checkGameOver = function() {\n    var endText;\n    if (!game.isTerminal()) {\n      return false;\n    }\n    endText = (function() {\n      switch (false) {\n        case !game.isWin(X):\n          return 'Green Wins!';\n        case !game.isWin(O):\n          return 'Red Wins!';\n        default:\n          return 'Draw!';\n      }\n    })();\n    $('#end-text').text(endText);\n    $('#modal-game-over').modal('show');\n    return true;\n  };\n  playAction = function(action) {\n    var columnIndex, index, playerText;\n    columnIndex = action % 7;\n    hideSpinner();\n    index = game.openPosition(columnIndex);\n    playerText = game.nextPlayer === X ? 'x' : 'o';\n    ($(\"#\" + index)).addClass(playerText + '-tile');\n    game = game.play(action);\n    lastAction = action;\n    return next();\n  };\n  playerX = null;\n  playerO = null;\n  next = function() {\n    var player;\n    unplayable();\n    markWin();\n    player = game.nextPlayer === X ? playerX : playerO;\n    return player.play();\n  };\n  players = {\n    human: function() {\n      return humanPlayer();\n    },\n    'starter AI': function() {\n      return computerPlayer(3);\n    },\n    'smart AI': function() {\n      return computerPlayer(4);\n    }\n  };\n  createPlayerX = function() {\n    var playerName;\n    playerName = ($('#btn-player-x')).text();\n    return players[playerName]();\n  };\n  createPlayerO = function() {\n    var playerName;\n    playerName = ($('#btn-player-o')).text();\n    return players[playerName]();\n  };\n  swapPlayers = function() {\n    var $o, $x, tmp;\n    $x = $('#btn-player-x');\n    $o = $('#btn-player-o');\n    tmp = $x.text();\n    $x.text($o.text());\n    return $o.text(tmp);\n  };\n  $('.player').on('click', function() {\n    var $btn, $player, currentPlayerName, playerFor, playerName;\n    $player = $(this);\n    playerFor = $player.data('player-for');\n    $btn = $(\"#btn-player-\" + playerFor);\n    playerName = $player.text();\n    currentPlayerName = $btn.text();\n    if (currentPlayerName !== playerName) {\n      $btn.text(playerName);\n      return setup();\n    }\n  });\n  humanPlayer = function() {\n    var int;\n    int = function(s) {\n      return parseInt(s, 10);\n    };\n    return {\n      setup: function(done) {\n        return done();\n      },\n      play: function() {\n        var playableClassName;\n        if (checkGameOver()) {\n          return;\n        }\n        playableClassName = playable();\n        return $(\".\" + playableClassName).addClass('human-playable-tile').on('click', function() {\n          var $tile, action;\n          $tile = $(this);\n          action = int($tile.get(0).id);\n          return playAction(action);\n        });\n      }\n    };\n  };\n  computerPlayer = function(depth) {\n    var worker;\n    if (depth == null) {\n      depth = 3;\n    }\n    worker = new Worker('src/minimax-worker.min.js');\n    return {\n      setup: function(done) {\n        worker.onmessage = function(e) {\n          return playAction(e.data.action);\n        };\n        worker.postMessage({\n          command: 'setup',\n          args: {\n            depth: depth\n          }\n        });\n        return done();\n      },\n      play: function() {\n        if (checkGameOver()) {\n          return;\n        }\n        playable();\n        showSpinner();\n        return worker.postMessage({\n          command: 'play',\n          args: {\n            lastAction: lastAction\n          }\n        });\n      },\n      teardown: function() {\n        return worker.terminate();\n      }\n    };\n  };\n  setup = function() {\n    var ref2;\n    teardown();\n    game = new ConnectFour;\n    game.lastPlayedPosition = null;\n    lastAction = null;\n    ref2 = [createPlayerX(), createPlayerO()], playerX = ref2[0], playerO = ref2[1];\n    return playerX.setup(function() {\n      return playerO.setup(function() {\n        return next();\n      });\n    });\n  };\n  teardown = function() {\n    if (playerX != null) {\n      if (typeof playerX.teardown === \"function\") {\n        playerX.teardown();\n      }\n    }\n    if (playerO != null) {\n      if (typeof playerO.teardown === \"function\") {\n        playerO.teardown();\n      }\n    }\n    hideSpinner();\n    return $('.tile').removeClass('x-tile').removeClass('o-tile').removeClass('x-won-tile').removeClass('o-won-tile');\n  };\n  newGame = function() {\n    swapPlayers();\n    return setup();\n  };\n  $('#btn-new-game').on('click', newGame);\n  return setup();\n});\n\n\n},{\"./connect-four\":1,\"./spinner\":3}],3:[function(require,module,exports){\nvar $, hideSpinner, showSpinner, spinner, spinnerThresholdMs, spinnerTimeout;\n\n$ = jQuery;\n\nspinner = new Spinner({\n  lines: 9,\n  radius: 7,\n  length: 7\n});\n\nspinnerTimeout = null;\n\nspinnerThresholdMs = 100;\n\nshowSpinner = function() {\n  var target;\n  if (spinnerTimeout == null) {\n    target = ($('#spinner')).get(0);\n    return spinnerTimeout = setTimeout((function() {\n      return spinner.spin(target);\n    }), spinnerThresholdMs);\n  }\n};\n\nhideSpinner = function() {\n  if (spinnerTimeout != null) {\n    clearTimeout(spinnerTimeout);\n  }\n  spinner.stop();\n  return spinnerTimeout = null;\n};\n\nmodule.exports = {\n  showSpinner: showSpinner,\n  hideSpinner: hideSpinner\n};\n\n\n},{}],4:[function(require,module,exports){\nvar P1, P2, ref;\n\nref = [1, 2], P1 = ref[0], P2 = ref[1];\n\nmodule.exports = {\n  P1: P1,\n  P2: P2\n};\n\n},{}],5:[function(require,module,exports){\nvar Limit, MAX, MIN, MinimaxAgent, P1, P2, ref, ref1;\n\nref = require('./game'), P1 = ref.P1, P2 = ref.P2;\n\nref1 = [P1, P2], MAX = ref1[0], MIN = ref1[1];\n\nLimit = Number.MAX_SAFE_INTEGER;\n\nMinimaxAgent = (function() {\n  function MinimaxAgent(depth) {\n    this.depth = depth != null ? depth : Limit;\n    this.rootAgent = MAX;\n  }\n\n  MinimaxAgent.prototype.nextAction = function(state) {\n    var _, bestAction, ref2;\n    this.rootAgent = state.nextAgent();\n    ref2 = this.minimax(state), _ = ref2[0], bestAction = ref2[1];\n    return bestAction;\n  };\n\n  MinimaxAgent.prototype.minimax = function(state, α, β, ply) {\n    var isTerminal;\n    if (α == null) {\n      α = -Limit;\n    }\n    if (β == null) {\n      β = +Limit;\n    }\n    if (ply == null) {\n      ply = 0;\n    }\n    isTerminal = state.isTerminal();\n    if (!isTerminal && state.nextAgent() === this.rootAgent) {\n      ++ply;\n    }\n    if (ply > this.depth || isTerminal) {\n      return [state.utility(), null];\n    } else if (state.nextAgent() === MAX) {\n      return this.maxi(state, α, β, ply);\n    } else {\n      return this.mini(state, α, β, ply);\n    }\n  };\n\n  MinimaxAgent.prototype.maxi = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref2, ref3, ref4, ref5, successor, v;\n    ref2 = [-Limit, null], v = ref2[0], a = ref2[1];\n    ref3 = state.possibleActions();\n    for (i = 0, len = ref3.length; i < len; i++) {\n      action = ref3[i];\n      successor = state.play(action);\n      ref4 = this.minimax(successor, α, β, ply), nextValue = ref4[0], _ = ref4[1];\n      if (nextValue > v) {\n        ref5 = [nextValue, action], v = ref5[0], a = ref5[1];\n      }\n      if (v >= β) {\n        return [v, a];\n      }\n      α = Math.max(α, v);\n    }\n    return [v, a];\n  };\n\n  MinimaxAgent.prototype.mini = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref2, ref3, ref4, ref5, successor, v;\n    ref2 = [+Limit, null], v = ref2[0], a = ref2[1];\n    ref3 = state.possibleActions();\n    for (i = 0, len = ref3.length; i < len; i++) {\n      action = ref3[i];\n      successor = state.play(action);\n      ref4 = this.minimax(successor, α, β, ply), nextValue = ref4[0], _ = ref4[1];\n      if (nextValue < v) {\n        ref5 = [nextValue, action], v = ref5[0], a = ref5[1];\n      }\n      if (v <= α) {\n        return [v, a];\n      }\n      β = Math.min(β, v);\n    }\n    return [v, a];\n  };\n\n  return MinimaxAgent;\n\n})();\n\nmodule.exports = {\n  MAX: MAX,\n  MIN: MIN,\n  Limit: Limit,\n  MinimaxAgent: MinimaxAgent\n};\n\n},{\"./game\":4}]},{},[2])\n\n","  # coffeelint: disable=max_line_length\n\n$ = jQuery\n\n{X, O, ConnectFour} = require './connect-four'\n\n{showSpinner, hideSpinner} = require './spinner'\n\n$ ->\n\n  game = null\n  lastAction = null\n\n  playable = ->\n    className =\n      if game.nextPlayer is X then 'x-playable-tile' else 'o-playable-tile'\n    for i in game.freePositions()\n      $ \"##{i}\"\n        .addClass className\n    className\n\n  unplayable = ->\n    $ '.tile'\n      .removeClass 'x-playable-tile'\n      .removeClass 'o-playable-tile'\n      .removeClass 'human-playable-tile'\n      .off 'click'\n\n  markWin = ->\n    for i in game.winOn()\n      wonClass = if game.isWin X then 'x-won-tile' else 'o-won-tile'\n      ($ \"##{i}\").addClass wonClass\n\n  checkGameOver = ->\n    return no unless game.isTerminal()\n    endText = switch\n      when game.isWin X then 'Green Wins!'\n      when game.isWin O then 'Red Wins!'\n      else 'Draw!'\n    $ '#end-text'\n      .text endText\n    $ '#modal-game-over'\n      .modal('show')\n    yes\n\n  playAction = (action) ->\n    columnIndex = action % 7\n    hideSpinner()\n    index = game.openPosition columnIndex\n    playerText = if game.nextPlayer is X then 'x' else 'o'\n    ($ \"##{index}\").addClass playerText + '-tile'\n    game = game.play action\n    lastAction = action\n    next()\n\n  # player :: {\n  #   setup : (done: ->) ->\n  #   teardown : ->\n  #   play : ->\n  # }\n\n  playerX = null\n  playerO = null\n\n  next = ->\n    unplayable()\n    markWin()\n    player = if game.nextPlayer is X then playerX else playerO\n    player.play()\n\n  players =\n    human: -> humanPlayer()\n    'starter AI': -> computerPlayer 3\n    'smart AI': -> computerPlayer 4\n\n  createPlayerX = ->\n    playerName = ($ '#btn-player-x').text()\n    players[playerName]()\n  createPlayerO = ->\n    playerName = ($ '#btn-player-o').text()\n    players[playerName]()\n\n  swapPlayers = ->\n    $x = $ '#btn-player-x'\n    $o = $ '#btn-player-o'\n    tmp = $x.text()\n    $x.text $o.text()\n    $o.text tmp\n\n  $ '.player'\n    .on 'click', ->\n      $player = $ this\n      playerFor = $player.data 'player-for'\n      $btn = $ \"#btn-player-#{playerFor}\"\n      playerName = $player.text()\n      currentPlayerName = $btn.text()\n      if currentPlayerName isnt playerName\n        $btn.text playerName\n        setup()\n\n  humanPlayer = ->\n    int = (s) -> parseInt s, 10\n    setup: (done) -> done()\n    play: ->\n      return if checkGameOver()\n      playableClassName = playable()\n      $ \".#{playableClassName}\"\n        .addClass 'human-playable-tile'\n        .on 'click', ->\n          $tile = $ this\n          action = int $tile.get(0).id\n          playAction action\n\n  computerPlayer = (depth = 3) ->\n    worker = new Worker 'src/minimax-worker.min.js'\n    setup: (done) ->\n      worker.onmessage = (e) -> playAction e.data.action\n      worker.postMessage command: 'setup', args: {depth}\n      done()\n    play: ->\n      return if checkGameOver()\n      playable()\n      showSpinner()\n      worker.postMessage command: 'play', args: {lastAction}\n    teardown: -> worker.terminate()\n\n  setup = ->\n    teardown()\n    game = new ConnectFour\n    game.lastPlayedPosition = null # start with the full board open\n    lastAction = null\n    [playerX, playerO] = [createPlayerX(), createPlayerO()]\n    playerX.setup -> playerO.setup -> next()\n\n  teardown = ->\n    playerX?.teardown?()\n    playerO?.teardown?()\n    hideSpinner()\n    $ '.tile'\n      .removeClass 'x-tile'\n      .removeClass 'o-tile'\n      .removeClass 'x-won-tile'\n      .removeClass 'o-won-tile'\n\n  newGame = ->\n    swapPlayers()\n    setup()\n\n  $ '#btn-new-game'\n    .on 'click', newGame\n\n  setup()\n","$ = jQuery\r\n\r\nspinner = new Spinner lines: 9, radius: 7, length: 7\r\nspinnerTimeout = null\r\nspinnerThresholdMs = 100\r\nshowSpinner = ->\r\n  unless spinnerTimeout?\r\n    target = ($ '#spinner').get 0\r\n    spinnerTimeout =\r\n      setTimeout (-> spinner.spin target), spinnerThresholdMs\r\nhideSpinner = ->\r\n  clearTimeout spinnerTimeout if spinnerTimeout?\r\n  spinner.stop()\r\n  spinnerTimeout = null\r\n\r\nmodule.exports = {showSpinner, hideSpinner}\r\n","var P1, P2, ref;\n\nref = [1, 2], P1 = ref[0], P2 = ref[1];\n\nmodule.exports = {\n  P1: P1,\n  P2: P2\n};\n","var Limit, MAX, MIN, MinimaxAgent, P1, P2, ref, ref1;\n\nref = require('./game'), P1 = ref.P1, P2 = ref.P2;\n\nref1 = [P1, P2], MAX = ref1[0], MIN = ref1[1];\n\nLimit = Number.MAX_SAFE_INTEGER;\n\nMinimaxAgent = (function() {\n  function MinimaxAgent(depth) {\n    this.depth = depth != null ? depth : Limit;\n    this.rootAgent = MAX;\n  }\n\n  MinimaxAgent.prototype.nextAction = function(state) {\n    var _, bestAction, ref2;\n    this.rootAgent = state.nextAgent();\n    ref2 = this.minimax(state), _ = ref2[0], bestAction = ref2[1];\n    return bestAction;\n  };\n\n  MinimaxAgent.prototype.minimax = function(state, α, β, ply) {\n    var isTerminal;\n    if (α == null) {\n      α = -Limit;\n    }\n    if (β == null) {\n      β = +Limit;\n    }\n    if (ply == null) {\n      ply = 0;\n    }\n    isTerminal = state.isTerminal();\n    if (!isTerminal && state.nextAgent() === this.rootAgent) {\n      ++ply;\n    }\n    if (ply > this.depth || isTerminal) {\n      return [state.utility(), null];\n    } else if (state.nextAgent() === MAX) {\n      return this.maxi(state, α, β, ply);\n    } else {\n      return this.mini(state, α, β, ply);\n    }\n  };\n\n  MinimaxAgent.prototype.maxi = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref2, ref3, ref4, ref5, successor, v;\n    ref2 = [-Limit, null], v = ref2[0], a = ref2[1];\n    ref3 = state.possibleActions();\n    for (i = 0, len = ref3.length; i < len; i++) {\n      action = ref3[i];\n      successor = state.play(action);\n      ref4 = this.minimax(successor, α, β, ply), nextValue = ref4[0], _ = ref4[1];\n      if (nextValue > v) {\n        ref5 = [nextValue, action], v = ref5[0], a = ref5[1];\n      }\n      if (v >= β) {\n        return [v, a];\n      }\n      α = Math.max(α, v);\n    }\n    return [v, a];\n  };\n\n  MinimaxAgent.prototype.mini = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref2, ref3, ref4, ref5, successor, v;\n    ref2 = [+Limit, null], v = ref2[0], a = ref2[1];\n    ref3 = state.possibleActions();\n    for (i = 0, len = ref3.length; i < len; i++) {\n      action = ref3[i];\n      successor = state.play(action);\n      ref4 = this.minimax(successor, α, β, ply), nextValue = ref4[0], _ = ref4[1];\n      if (nextValue < v) {\n        ref5 = [nextValue, action], v = ref5[0], a = ref5[1];\n      }\n      if (v <= α) {\n        return [v, a];\n      }\n      β = Math.min(β, v);\n    }\n    return [v, a];\n  };\n\n  return MinimaxAgent;\n\n})();\n\nmodule.exports = {\n  MAX: MAX,\n  MIN: MIN,\n  Limit: Limit,\n  MinimaxAgent: MinimaxAgent\n};\n"]}